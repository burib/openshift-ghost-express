machine:
  node:
    version: 6.9.0
  post:
    - curl -o- -L https://yarnpkg.com/install.sh | bash
    - npm install -g npm@latest
    - node -v && yarn --version && npm --version

dependencies:
  override:
    # UPDATING DEPENDENCIES
    - sudo apt-get update
    - sudo apt-get install lsb-base
    # INSTALLING NPM DEPENDENCIES
    - cd ./usr/template/
    - yarn install
    - cat yarn.lock
    - ls -la
  cache_directories:
    - ~/.cache/yarn

deployment:
  master-deploy:
    branch: master
    commands:
      - git config --global user.email "circle@example.com"
      - git config --global user.name "CircleCI"
      - git add . ./usr/template/node_modules/
      - git commit -m "update node_modules"
      - git status
      - git push -u origin release